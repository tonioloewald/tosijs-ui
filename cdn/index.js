import{Component as e,elements as t,xinValue as i,xin as s,vars as a,debounce as o,varDefault as n}from"xinjs";import{marked as r}from"marked";let l={};function d(e,i){if(void 0===l[e]){if(void 0!==i){let t=globalThis[i];l[e]=Promise.resolve({[i]:t})}let s=t.script({src:e});document.head.append(s),l[e]=new Promise(e=>{s.onload=()=>e(globalThis)})}return l[e]}let h={};function c(e){if(void 0===h[e]){let i=t.link({rel:"stylesheet",type:"text/css",href:e});document.head.append(i),h[e]=new Promise(e=>{i.onload=e})}return h[e]}class u extends e{content=null;src="";json="";config={renderer:"svg",loop:!0,autoplay:!0};static bodymovinAvailable;animation;styleNode=e.StyleNode({":host":{width:400,height:400,display:"inline-block"}});_loading=!1;get loading(){return this._loading}constructor(){super(),this.initAttributes("src","json"),void 0===u.bodymovinAvailable&&(u.bodymovinAvailable=d("https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js","bodymovin"))}doneLoading=()=>{this._loading=!1};load=({bodymovin:e})=>{this._loading=!0,this.config.container=this.shadowRoot,""!==this.json?(this.config.animationData=this.json,delete this.config.path):""!==this.src?(delete this.config.animationData,this.config.path=this.src):console.log("%c<bodymovin-player>%c expected either %cjson%c (animation data) or %csrc% c(url) but found neither.","color: #44f; background: #fff; padding: 0 5px","color: default","color: #44f; background: #fff; padding: 0 5px","color: default","color: #44f; background: #fff; padding: 0 5px","color: default"),this.animation&&(this.animation.destroy(),this.shadowRoot.querySelector("svg").remove()),this.animation=e.loadAnimation(this.config),this.animation.addEventListener("DOMLoaded",this.doneLoading)};render(){super.render(),u.bodymovinAvailable.then(this.load).catch(e=>{console.error(e)})}}let p=u.elementCreator({tag:"bodymovin-player"}),m="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.2/",b="ace/theme/monokai",v=async(e,t="html",i={},s=b)=>{let{ace:a}=await d(`${m}ace.min.js`);a.config.set("basePath",m);let o=a.edit(e,{mode:`ace/mode/${t}`,tabSize:2,useSoftTabs:!0,useWorker:!1,...i});return o.setTheme(s),o};class f extends e{value="";mode="javascript";disabled=!1;role="code editor";get editor(){return this._editor}_editor;_editorPromise;options={};theme=b;styleNode=e.StyleNode({":host":{display:"block",position:"relative"}});constructor(){super(),this.initAttributes("mode","theme","disabled")}onResize(){void 0!==this.editor&&this.editor.resize(!0)}updateValue=async e=>{e.target!==this&&this.editor&&(this.value=this.editor.getValue())};connectedCallback(){super.connectedCallback(),""===this.value&&(this.value=this.textContent.trim("\n")),void 0===this._editorPromise&&(this._editorPromise=v(this,this.mode,this.options,this.theme),this._editorPromise.then(e=>{this._editor=e,e.setValue(this.value,1)})),this.addEventListener("change",this.updateValue)}render(){super.render(),void 0!==this.editor&&this.editor.getValue()!==this.value&&this.editor.setValue(this.value),void 0!==this._editorPromise&&this._editorPromise.then(e=>e.setReadOnly(this.disabled))}}let g=f.elementCreator({tag:"code-editor"}),y=(e,i,s="default")=>{let a=e.type.startsWith("touch");if(a){if(e.type.startsWith("touch")){let t=e.touches[0].clientX,s=e.touches[0].clientY,a=e.target,o=0,n=0,r=e=>{e.touches.length>0&&(o=e.touches[0].clientX-t,n=e.touches[0].clientY-s),(!0===i(o,n,e)||0===e.touches.length)&&(a.removeEventListener("touchmove",r),a.removeEventListener("touchend",r),a.removeEventListener("touchcancel",r))};a.addEventListener("touchmove",r,{passive:!0}),a.addEventListener("touchend",r,{passive:!0}),a.addEventListener("touchcancel",r,{passive:!0})}}else{let a=e.clientX,o=e.clientY,n=t.div({style:{content:" ",position:"fixed",top:0,left:0,right:0,bottom:0,cursor:s}});document.body.append(n);let r=e=>{let t=e.clientX-a,s=e.clientY-o;!0===i(t,s,e)&&n.remove()};n.addEventListener("mousemove",r,{passive:!0}),n.addEventListener("mouseup",r,{passive:!0})}},{div:x,span:w,template:$}=t,k=e=>e,C=(class extends e{get value(){return{array:this.array,filter:this.filter,columns:this.columns}}set value(e){let{array:t,columns:s,filter:a}=i(e);(this._array!==t||this._columns!==s||this._filter!==a)&&this.queueRender(),this._array=t||[],this._columns=s||null,this._filter=a||k}_array=[];_columns=null;_filter=k;charWidth=15;rowHeight=30;minColumnWidth=30;get virtual(){return this.rowHeight>0?{height:this.rowHeight}:void 0}constructor(){super(),this.initAttributes("rowHeight","charWidth","minColumnWidth")}get array(){return this._array}set array(e){this._array=i(e),this.queueRender()}get filter(){return this._filter}set filter(e){this._filter!==e&&(this._filter=e,this.queueRender())}get columns(){if(!Array.isArray(this._columns)){let{_array:e}=this;this._columns=Object.keys(e[0]||{}).map(t=>{let i=function(e,t,i){let s=e.find(e=>void 0!==e[t]&&null!==e[t]);if(void 0!==s){let e=s[t];switch(typeof e){case"string":if(e.match(/^\d+(\.\d+)?$/))return 6*i;if(e.includes(" "))return 20*i;return 12*i;case"number":return 6*i;case"boolean":return 5*i;case"object":break;default:return 8*i}}return!1}(e,t,this.charWidth);return{name:t.replace(/([a-z])([A-Z])/g,"$1 $2").toLocaleLowerCase(),prop:t,align:"number"!=typeof e[0][t]&&(""===e[0][t]||isNaN(e[0][t]))?"left":"right",visible:!1!==i,width:i||0}})}return this._columns}set columns(e){this._columns=e,this.queueRender()}get visibleColumns(){return this.columns.filter(e=>!1!==e.visible)}get visibleRecords(){return s[this.instanceId]}content=null;getColumn(e){let t=(void 0!==e.touches?e.touches[0].clientX:e.clientX)-this.getBoundingClientRect().x,i=void 0!==e.touches?20:5,s=0,a=[],o=this.visibleColumns.find(e=>{if(!1!==e.visible)return s+=e.width,a.push(s),Math.abs(t-s)<i});return o}setCursor=e=>{let t=this.getColumn(e);void 0!==t?this.style.cursor="col-resize":this.style.cursor=""};resizeColumn=e=>{let t=this.getColumn(e);if(void 0!==t){let i=t.width,s=void 0!==e.touches,a=s?e.touches[0].identifier:void 0;y(e,(e,o,n)=>{let r=!s||[...n.touches].find(e=>e.identifier===a);if(void 0===r)return!0;let l=i+e;if(t.width=l>this.minColumnWidth?l:this.minColumnWidth,this.setColumnWidths(),"mouseup"===n.type)return!0},"col-resize")}};connectedCallback(){super.connectedCallback(),this.addEventListener("mousemove",this.setCursor),this.addEventListener("mousedown",this.resizeColumn),this.addEventListener("touchstart",this.resizeColumn,{passive:!0})}setColumnWidths(){this.style.setProperty("--grid-columns",this.visibleColumns.map(e=>e.width+"px").join(" "))}get rowStyle(){return{display:"grid",gridTemplateColumns:a.gridColumns,height:this.rowHeight+"px",lineHeight:this.rowHeight+"px"}}get cellStyle(){return{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}headerCell=e=>void 0!==e.headerCell?e.headerCell():w({class:"th",role:"columnheader",ariaSort:"none",style:{...this.cellStyle,textAlign:e.align||"left"}},"string"==typeof e.name?e.name:e.prop);dataCell=e=>void 0!==e.dataCell?e.dataCell(e):w({class:"td",role:"cell",style:{...this.cellStyle,textAlign:e.align||"left"},bindText:`^.${e.prop}`});get visibleRows(){return i(s[this.instanceId])}render(){super.render(),s[this.instanceId]=this.filter(this._array),this.textContent="",this.style.display="flex",this.style.flexDirection="column";let{visibleColumns:e}=this;this.setColumnWidths(),this.append(x({class:"thead",role:"rowgroup"},x({class:"tr",role:"row",style:this.rowStyle},...e.map(this.headerCell))),x({class:"tbody",role:"rowgroup",style:{content:" ",minHeight:"200px",flex:"1 1 100px",overflow:"hidden",overflowY:"scroll"},bindList:{value:this.instanceId,virtual:this.virtual}},$(x({class:"tr",role:"row",style:this.rowStyle},...e.map(this.dataCell)))))}}).elementCreator({tag:"data-table"}),{input:L}=t,S=e=>e,_="null filter, everything matches",N=[{hint:"field=value",explanation:"field is value, ignoring case",description:(e,t)=>isNaN(Number(t))?""!==e?`${e} is "${t}"`:`any field is "${t}"`:""!==e?`${e} == ${t}`:`any field == ${t}`,token:/^([\w-_]*)=(.+)$/,makeFilter:(e,t)=>{if(isNaN(Number(t)))return(t=String(t).toLocaleLowerCase(),""!==e)?i=>String(i[e]).toLocaleLowerCase()==t:e=>void 0!==Object.values(e).find(e=>String(e).toLocaleLowerCase()==t);let i=Number(t);return""!==e?t=>Number(t[e])==i:e=>void 0!==Object.values(e).find(e=>Number(e)==i)}},{hint:"field!=value",explanation:"field is not value, ignoring case",description:(e,t)=>`${e} â‰  ${t}`,token:/^([\w-_]+)!=(.+)$/,makeFilter:(e,t)=>(t=t.toLocaleLowerCase(),i=>String(i[e]).toLocaleLowerCase()!=t)},{hint:"field>value",explanation:"field > value (numeric / A-Z)",description:(e,t)=>isNaN(Number(t))?`${e} > ${t} (A-Z)`:`${e} > ${t}`,token:/^([\w-_]+)>(.+)$/,makeFilter:(e,t)=>{if(!isNaN(Number(t))){let i=Number(t);return t=>Number(t[e])>i}return t=t.toLocaleLowerCase(),i=>String(i[e]).toLocaleLowerCase()>t}},{hint:"field<value",explanation:"field < value (numeric / A-Z)",description:(e,t)=>isNaN(Number(t))?`${e} < ${t} (A-Z)`:`${e} < ${t}`,token:/^([\w-_]+)<(.+)$/,makeFilter:(e,t)=>{if(!isNaN(Number(t))){let i=Number(t);return t=>Number(t[e])<i}return t=t.toLocaleLowerCase(),i=>String(i[e]).toLocaleLowerCase()<t}},{hint:"field:value",explanation:"field contains value, ignoring case",description:(e,t)=>`${e} contains "${t}"`,token:/^([\w-_]+):(.+)$/,makeFilter:(e,t)=>(t=t.toLocaleLowerCase(),i=>String(i[e]).toLocaleLowerCase().includes(t))},{hint:"!!field",explanation:"field is true, non-empty, non-zero",description:e=>`${e} is truthy`,token:/^!!([\w-_]+)$/,makeFilter:e=>t=>!!t[e]},{hint:"!field",explanation:"field is false, empty, zero",description:e=>`${e} is falsy`,token:/^!([\w-_]+)$/,makeFilter:e=>t=>!t[e]},{hint:"value",explanation:"any field contains value",description:e=>`"${e}" in any property`,token:/^(.+)$/,makeFilter:e=>(e=e.toLocaleLowerCase(),t=>void 0!==Object.values(t).find(t=>String(t).toLocaleLowerCase().includes(e)))}];class A extends e{value="";filter=S;title=_;content=L({type:"search",part:"input",style:{width:"100%",height:"auto"}});placeholder="";help="";filters=N;constructor(){super(),this.initAttributes("title","placeholder","help")}buildFilter=o(e=>{let t=e.split(/\s+/).filter(e=>""!==e).map(e=>(function(e,t=N){let i=t.find(t=>t.token.test(e));if(void 0!==i){let[,...t]=e.match(i.token);return{description:i.description(...t),test:i.makeFilter(...t)}}})(e,this.filters)).filter(e=>void 0!==e);0===t.length?(this.title=_,this.filter!==S&&(this.filter=S,this.dispatchEvent(new Event("change")))):(this.filter=t.reduce((e,t)=>!1===e?e=>e.filter(t.test):i=>e(i.filter(t.test)),!1),this.title=t.map(e=>e.description).join(", and "),this.dispatchEvent(new Event("change")))},500);reset(){this.filter!==S&&(this.title=_,this.filter=S,this.dispatchEvent(new Event("change")))}handleInput=e=>{let{input:t}=this.parts;this.buildFilter(t.value),this.value=t.value,e.stopPropagation(),e.preventDefault()};connectedCallback(){super.connectedCallback(),this.setAttribute("title",this.title),this.help=this.filters.map(e=>void 0!==e.explanation?`${e.hint}: ${e.explanation}`:e.hint).join("\n");let{input:e}=this.parts;e.value=this.value,e.addEventListener("input",this.handleInput),e.addEventListener("change",this.handleInput),this.style.position="relative"}render(){super.render();let{input:e}=this.parts;e.placeholder=""!==this.placeholder?this.placeholder:this.filters.map(e=>e.hint).join(" "),e.value=this.value}}let z=A.elementCreator({tag:"filter-builder"}),P=[{name:"streets",url:"mapbox://styles/mapbox/streets-v10"},{name:"outdoors",url:"mapbox://styles/mapbox/outdoors-v10"},{name:"light",url:"mapbox://styles/mapbox/light-v9"},{name:"dark",url:"mapbox://styles/mapbox/dark-v9"},{name:"satellite",url:"mapbox://styles/mapbox/satellite-v9"},{name:"sateliite + streets",url:"mapbox://styles/mapbox/satellite-streets-v10"},{name:"preview day",url:"mapbox://styles/mapbox/navigation-preview-day-v2"},{name:"preview night",url:"mapbox://styles/mapbox/navigation-preview-night-v2"},{name:"guidance day",url:"mapbox://styles/mapbox/navigation-guidance-day-v2"},{name:"guidance night",url:"mapbox://styles/mapbox/navigation-guidance-night-v2"}],{div:E}=t;class j extends e{coords="65.01715565258993,25.48081004203459,12";content=E({style:{width:"100%",height:"100%"}});get map(){return this._map}mapStyle=P[0];token="";static mapboxCSSAvailable;static mapboxAvailable;_map;styleNode=e.StyleNode({":host":{display:"inline-block",position:"relative",width:"400px",height:"400px",textAlign:"left"}});constructor(){super(),this.initAttributes("coords","token","mapStyle"),void 0===j.mapboxCSSAvailable&&(j.mapboxCSSAvailable=c("https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css").catch(e=>{console.error("failed to load mapbox-gl.css",e)}),j.mapboxAvailable=d("https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js").catch(e=>{console.error("failed to load mapbox-gl.js",e)}))}connectedCallback(){super.connectedCallback(),this.token||console.error("mapbox requires an access token which you can provide via the token attribute")}render(){if(super.render(),!this.token)return;let{div:e}=this.parts,[t,i,s]=this.coords.split(",").map(e=>Number(e));this.map&&this.map.remove(),j.mapboxAvailable.then(({mapboxgl:a})=>{console.log("%cmapbox may complain about missing css because it is loaded async on demand","background: orange; color: black; padding: 0 5px;"),a.accessToken=this.token,this._map=new a.Map({container:e,style:this.mapStyle.url,zoom:s,center:[i,t]}),this._map.on("render",()=>this._map.resize())})}}let T=j.elementCreator({tag:"map-box"}),R=(class extends e{src="";value="";content=null;constructor(){super(),this.initAttributes("src")}connectedCallback(){super.connectedCallback(),""!==this.src?(async()=>{let e=await fetch(this.src);this.value=await e.text()})():""===this.value&&(this.value=null!=this.textContent?this.textContent:"")}render(){super.render(),this.innerHTML=r(this.value,{mangle:!1,headerIds:!1})}}).elementCreator({tag:"markdown-viewer"}),{slot:W}=t,V={left:"row",right:"row-reverse",top:"column",bottom:"column-reverse"},D={left:["marginLeft","marginRight"],right:["marginRight","marginLeft"],top:["marginTop","marginBottom"],bottom:["marginBottom","marginTop"]};class H extends e{panelPosition="left";minSize=600;navSize=200;compact=!1;content=[W({name:"nav"}),W({part:"content"})];_contentVisible=!1;get contentVisible(){return this._contentVisible}set contentVisible(e){this._contentVisible=e,this.queueRender()}styleNode=e.StyleNode({":host":{display:"flex",flexDirection:a.flexDirection,transition:n.sideNavTransition("0.25s ease-out")},":host slot":{position:"relative"},":host slot:not([name])":{display:"block",flex:`0 0 ${a.contentWidth}`,width:a.contentWidth},':host slot[name="nav"]':{display:"block",flex:`0 0 ${a.navWidth}`,width:a.navWidth}});onResize=()=>{let{content:e}=this.parts;if(null===this.offsetParent)return;this.style.marginLeft=0,this.style.marginRight=0,this.style.marginTop=0,this.style.marginBottom=0;let t=void 0===[...this.childNodes].find(e=>!(e instanceof Element)||"nav"!==e.getAttribute("slot"));if(t){this.style.setProperty("--nav-width","100%"),this.style.setProperty("--content-width","0%");return}let i=this.offsetParent,s=(this.panelPosition.match(/left|right/),i.offsetWidth);if(this.compact=s<this.minSize,this.compact){e.classList.remove("-side-nav-visible"),this.style.setProperty("--nav-width","50%"),this.style.setProperty("--content-width","50%");let t=D[this.panelPosition];this.contentVisible?this.style[t[0]]="-100%":this.style[t[1]]="-100%"}else e.classList.add("-side-nav-visible"),this.style.setProperty("--nav-width",`${this.navSize}px`),this.style.setProperty("--content-width",`calc(100% - ${this.navSize}px)`)};observer;connectedCallback(){super.connectedCallback(),this.contentVisible=0===this.parts.content.childNodes.length,globalThis.addEventListener("resize",this.onResize),this.observer=new MutationObserver(this.onResize),this.observer.observe(this,{childList:!0})}disconnectedCallback(){super.disconnectedCallback(),this.observer.disconnect()}constructor(){super(),this.initAttributes("panelPosition","minSize","navSize","compact")}render(){super.render(),this.style.setProperty("--flex-direction",V[this.panelPosition]),this.onResize()}}let F=H.elementCreator({tag:"side-nav"}),{slot:O}=t;class I extends e{minWidth=0;minHeight=0;value="normal";content=[O({part:"normal"}),O({part:"small",name:"small"})];styleNode=e.StyleNode({":host":{position:"relative"}});constructor(){super(),this.initAttributes("minWidth","minHeight")}onResize=()=>{let{normal:e,small:t}=this.parts;null!==this.offsetParent&&(this.offsetParent.offsetWidth<this.minWidth||this.offsetParent.offsetHeight<this.minHeight?(e.hidden=!0,t.hidden=!1,this.value="small"):(e.hidden=!1,t.hidden=!0,this.value="normal"))};connectedCallback(){super.connectedCallback(),globalThis.addEventListener("resize",this.onResize)}disconnectedCallback(){super.disconnectedCallback(),globalThis.removeEventListener("resize",this.onResize)}}let q=I.elementCreator({tag:"size-break"}),{div:B,slot:X}=t;class Y extends e{value=0;role="tabpanel";styleNode=e.StyleNode({":host":{display:"flex",flexDirection:"column",position:"relative",overflow:"hidden"},slot:{position:"relative",display:"block",flex:"1 1 auto",overflow:"hidden",overflowY:"auto"},"::slotted([hidden])":{display:"none !important"},":host .tab-holder":{display:"flex",flexDirection:"column"},":host .tabs":{display:"flex",userSelect:"none",whiteSpace:"nowrap"},":host .tabs > div":{padding:`${a.spacing50} ${a.spacing}`,cursor:"default"},':host .tabs > [aria-selected="true"]':{color:a.tabSelectorSelectedColor},":host .border":{background:"var(--tab-selector-bar-color, #ccc)"},":host .border > .selected":{content:" ",width:0,height:"var(--tab-selector-bar-height, 2px)",background:a.tabSelectorSelectedColor,transition:"ease-out 0.2s"}});content=[B({class:"tab-holder"},B({class:"tabs",part:"tabs"}),B({class:"border"},B({class:"selected",part:"selected"}))),X()];constructor(){super(),this.initAttributes("anne","example")}addTabBody(e,t=!1){if(!e.hasAttribute("name"))throw Error("element has no name attribute",e);this.shadowRoot.append(e),this.setupTabs(),t&&(this.value=this.bodies.length-1),this.queueRender()}keyTab=e=>{let{tabs:t}=this.parts,i=[...t.children].indexOf(e.target);switch(e.key){case"ArrowLeft":this.value=(i+Number(t.children.length)-1)%t.children.length,t.children[this.value].focus(),e.preventDefault();break;case"ArrowRight":this.value=(i+1)%t.children.length,t.children[this.value].focus(),e.preventDefault();break;case" ":this.pickTab(e),e.preventDefault()}};get bodies(){return[...this.children].filter(e=>e.hasAttribute("name"))}pickTab=e=>{let{tabs:t}=this.parts,i=e.target,s=[...t.children].indexOf(i);s>-1&&(this.value=s)};setupTabs=()=>{let{tabs:e}=this.parts,t=[...this.childNodes].filter(e=>e.hasAttribute("name"));for(let i in e.textContent="",t){let s=t[i],a=s.getAttribute("name"),o=`${this.instanceId}-${i}`;s.id=o,e.append(B(a,{tabindex:0,role:"tab",ariaControls:o}))}};connectedCallback(){super.connectedCallback();let{tabs:e}=this.parts;e.addEventListener("click",this.pickTab),e.addEventListener("keydown",this.keyTab),this.setupTabs()}render(){let{tabs:e,selected:t}=this.parts,i=this.bodies;for(let s=0;s<i.length;s++){let a=i[s],o=e.children[s];this.value===Number(s)?(o.setAttribute("aria-selected",!0),t.style.marginLeft=`${o.offsetLeft-e.offsetLeft}px`,t.style.width=`${o.offsetWidth}px`,a.removeAttribute("hidden")):(o.removeAttribute("aria-selected"),a.setAttribute("hidden",""))}}}let M=Y.elementCreator({tag:"tab-selector"});function Z(e,t=!0){return(i,s)=>{let a=e(i),o=e(s);for(let e in a)if(a[e]!==o[e])return t?a[e]>o[e]?1:-1:a[e]>o[e]?-1:1;return 0}}export{p as bodymovinPlayer,g as codeEditor,C as dataTable,z as filterBuilder,T as mapBox,R as markdownViewer,F as sideNav,q as sizeBreak,M as tabSelector,y as trackDrag,d as scriptTag,c as styleSheet,Z as makeSorter};
//# sourceMappingURL=index.js.map
